<!-- StepTimesDetail.razor -->
@if (CapabilityInfo != null)
{
    <MudExpansionPanel>
        <TitleContent>
            <div class="d-flex align-items-center">
                <MudIcon Icon="@Icons.Material.Filled.Schedule" Size="Size.Small" Class="mr-2" />
                <MudText Typo="Typo.body2" Color="Color.Info">
                    <strong>Step-by-Step Times (@(CapabilityInfo.StepTimes?.Count ?? 0) steps)</strong>
                </MudText>
                <MudSpacer />
                <MudText Typo="Typo.body2" Color="Color.Secondary">
                    <small><strong>Batch: @CapabilityInfo.BatchTime.ToString("G6") | Transfer: @CapabilityInfo.TransferTime.ToString("G6")</strong></small>
                </MudText>
            </div>
        </TitleContent>
        <ChildContent>
            @if (CapabilityInfo.StepTimes != null && CapabilityInfo.StepTimes.Any())
            {
                <MudList T="StepTimeDetail">
                    @for (int i = 0; i < CapabilityInfo.StepTimes.Count; i++)
                    {
                        var step = CapabilityInfo.StepTimes[i];
                        <MudListItem>
                            <AvatarContent>
                                <MudAvatar Color="Color.Info" Size="Size.Small">
                                    <MudText Typo="Typo.body2">@(i + 1)</MudText>
                                </MudAvatar>
                            </AvatarContent>
                            <ChildContent>
                                <div class="d-flex justify-content-between w-100 align-items-center">
                                    <MudText Typo="Typo.body2">
                                        <small>@step.StepDescription</small>
                                    </MudText>
                                    <MudText Typo="Typo.body2" Color="Color.Primary">
                                        <small><strong>@step.Time.ToString("G6")</strong></small>
                                    </MudText>
                                </div>
                            </ChildContent>
                        </MudListItem>
                    }
                </MudList>

                <MudDivider Class="my-2" />
                <div class="d-flex justify-content-between px-3">
                    <MudText Typo="Typo.body2" Color="Color.Secondary">
                        <small><strong>Total Steps Time:</strong></small>
                    </MudText>
                    <MudText Typo="Typo.body2" Color="Color.Secondary">
                        <small><strong>@CapabilityInfo.TotalStepsTime.ToString("G6")</strong></small>
                    </MudText>
                </div>
            }
            else
            {
                <MudText Typo="Typo.body2" Color="Color.Secondary" Class="pa-3">
                    <small>No step times available</small>
                </MudText>
            }
        </ChildContent>
    </MudExpansionPanel>
}

@code {
    [Parameter]
    public EquipmentCapabilityInfo CapabilityInfo { get; set; } = new();
}