@using Simulator.Shared.NuevaSimlationconQwen


<MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-1">
    <MudTabPanel Text="PFD">
        <NewMainProcessFlowDiagram MainProcessId=@MainProcessId Simulation=@Simulation isLoading=@isLoading RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></NewMainProcessFlowDiagram>
    </MudTabPanel>
    <MudTabPanel Text="Tanks">
        <TankTable MainProcessId="@MainProcessId" RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></TankTable>
    </MudTabPanel>
    <MudTabPanel Text="Pumps">
        <PumpTable MainProcessId="@MainProcessId" RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></PumpTable>
    </MudTabPanel>
    <MudTabPanel Text="Operators">
        <OperatorTable MainProcessId="@MainProcessId" RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></OperatorTable>
    </MudTabPanel>
    <MudTabPanel Text="Mixers">
        <MixerTable MainProcessId="@MainProcessId" RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></MixerTable>
    </MudTabPanel>
    <MudTabPanel Text="SKIDs">
        <ContinuousSystemTable MainProcessId="@MainProcessId" RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></ContinuousSystemTable>
    </MudTabPanel>
    <MudTabPanel Text="Lines">
        <LineTable MainProcessId="@MainProcessId" RefreshProcessFlowDiagram="RefreshProcessFlowDiagram"></LineTable>
    </MudTabPanel>

</MudTabs>

@code {
 
   
    
    public GeneralSimulation Simulation { get; set; } = new();
    [Parameter]
    public Guid MainProcessId { get; set; }

    public NewSimulationDTO SimulationDTO { get; set; } = new();
    bool isLoading { get; set; } = false;
    public async Task RefreshProcessFlowDiagram()
    {

        isLoading = true;

        var result = await GenericService.GetById<NewSimulationDTO, GetProcessByIdRequest>(new GetProcessByIdRequest()
        {
            MainProcessId = MainProcessId,



        });
        if (result.Succeeded)
        {

            _snackBar.ShowSuccess("Process flow digram was loaded succesfully");
            SimulationDTO = result.Data;
            isLoading = false;
            if (Simulation != null && SimulationDTO != null)
            {
                Simulation.ReadSimulationDataFromDTO(SimulationDTO);
            }

            StateHasChanged();


        }
        else
        {
            _snackBar.ShowError(result.Messages);
        }
    }
}

